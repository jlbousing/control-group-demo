<separator-title title="Crear Producci贸n"></separator-title>

<div class="w-full bg-white rounded-lg">
  <div  class="flex flex-col p-8">

    <loading *ngIf="loading"></loading>
    <form [formGroup]="form">
      <div class="w-full flex-col lg:flex flex-row justify-start">
        <h3>Seleccione la recta a producir:</h3>
      </div>
      <div class="w-full flex-col lg:flex flex-row justify-start">

        <div class="my-4 w-full lg:w-1/2 lg:mx-4">
          <label class="block text-gray-700 text-sm font-bold mb-2" for="assignament">
            Asignaci贸n
          </label>
          <select
            class="shadow appearance-none border
                   rounded w-full py-2 px-3 text-gray-700
                   leading-tight focus:outline-none
                   focus:shadow-outline"
            id="assignament"
            formControlName="assignament"
            (ngModelChange)="setAssignament($event)"
            >
            <option *ngFor="let assignament of assignaments" [ngValue]="assignament">
                {{ assignament.name}}
            </option>

          </select>
        </div>

        <div class="my-4 w-full lg:w-1/2 lg:mx-4">
          <label class="block text-gray-700 text-sm font-bold mb-2" for="assignament">
            Receta
          </label>
          <select
            class="shadow appearance-none border
                   rounded w-full py-2 px-3 text-gray-700
                   leading-tight focus:outline-none
                   focus:shadow-outline"
            id="assignament"
            formControlName="recipe"
            (ngModelChange)="setRecipe($event)"
            >
            <option *ngFor="let recipe of recipes" [ngValue]="recipe">
                {{ recipe.name }}
            </option>

          </select>
        </div>
      </div>

      <div class="w-full flex-col lg:flex flex-row justify-start">
        <h3>Indique los datos de la Producci贸n</h3>
      </div>
      <div class="w-full flex-col lg:flex flex-row justify-start">

        <div class="my-4 w-full lg:w-1/2 lg:mx-4">
          <label class="block text-gray-700 text-sm font-bold mb-2" for="quantity">
            Cantidad producida:
          </label>
          <input class="shadow appearance-none border
                        rounded w-full py-2 px-3 text-gray-700
                        leading-tight focus:outline-none
                        focus:shadow-outline"
                 type="number"
                 inputmode="numeric"
                 min="0"
                 placeholder="1"
                 [ngClass]="{'focus:border-red-700': form.value.quantity === 0}"
                 formControlName="quantity"
           />
        </div>
      </div>

      <div class="w-full flex-col lg:flex flex-row justify-start">
        <div class="my-4 w-full lg:w-1/2 lg:mx-4">
          <label class="block text-gray-700 text-sm font-bold mb-2" for="description">
            Observaciones
          </label>
          <textarea class="shadow appearance-none border
                           rounded w-full py-2 px-3 text-gray-700
                           leading-tight focus:outline-none
                           focus:shadow-outline"
                           formControlName="comments"
                           [ngClass]="{'focus:border-red-700': form.value.comments!.length < 3 || form.value.comments!.length > 250}">
          </textarea>
        </div>
      </div>

      <div class="w-full flex-col lg:flex flex-row justify-start">
        <div class="my-4 w-full lg:w-1/2 lg:mx-4">
          <label class="block text-gray-700 text-sm font-bold mb-2" for="description">
            Incidencias
          </label>
          <textarea class="shadow appearance-none border
                           rounded w-full py-2 px-3 text-gray-700
                           leading-tight focus:outline-none
                           focus:shadow-outline"
                           [ngClass]="{'focus:border-red-700': form.value.incidents!.length < 3 || form.value.incidents!.length > 250}"
                           formControlName="incidents">
          </textarea>
        </div>
      </div>

      <div class="my-4 w-full lg:w-1/2 lg:mx-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="template">
          Imagen de la Producci贸n
        </label>
        <input type="file" name="image" (change)="onFileSelected($event)">
      </div>

      <div class="my-4 w-full lg:w-1/2 lg:mx-4" *ngIf="imagenPrevia">
        <img [src]="imagenPrevia" class="flex flex-row justify-center"/>
      </div>

      <div class="w-full flex flex-row justify-center lg:justify-end mt-8">

        <div class="mx-4 lg:w-[10%]">
          <button data-modal-toggle="defaultModal"
          type="button"
          class="text-white
                 hover:bg-green-800
                   focus:ring-4
                   focus:outline-none
                 focus:ring-blue-300
                   font-medium rounded-lg
                   text-sm px-5 py-2.5 text-center"
          [ngClass]="{'bg-green-700': form.valid, 'bg-green-300': form.invalid}"
          [disabled]="form.invalid"
          (click)="onSubmit()">
                 Agregar
          </button>
        </div>
      </div>
    </form>
  </div>
</div>

